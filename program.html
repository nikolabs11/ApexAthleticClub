<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Program - Apex Athletic Club</title>
    <link rel="stylesheet" href="program.css">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.cells.min.js"></script>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init("orACw4cPmMD066o2G");
        })();
    </script>
</head>
<body>
    <div id="vanta-bg"></div>
    <div id="overlay">
        <div id="logo-container">
            <a href="/">
                <img id="club-logo" src="images/AAC Logo.png" alt="Apex Athletic Club Logo">
            </a>
        </div>
        
        <!-- Welcome section on dark background -->
        <div id="welcome-section">
            <h2>Welcome to Apex Athletic Club</h2>
            <h4>A Talent Factory for Promising Individuals</h4>
            <button id="build-program" class="cta-button">BUILD A SPORTS PROGRAM</button>
        </div>
    </div>

    <!-- Program selection section -->
    <div class="program-content" id="program-selection">
        <h3>Select Programs</h3>
        <!-- Indoor Soccer -->
        <div class="sport-option">
            <div class="sport-header">
                <input type="checkbox" id="indoor-soccer" name="programs" value="Indoor Soccer" checked disabled>
                <span class="sport-title">Indoor Soccer/Futsal (Required)</span>
            </div>
            <div class="sport-details">
                <div class="text-content">
                    <div class="timeline"><strong>October - February and May - August</strong></div>
                    <div class="age-group"><strong>2010s and younger</strong></div>
                    <div class="schedule"><strong>Mon/Tue/Sat/Sun Evenings</strong></div>
                    <ul>
                        <li>Professional, licensed coaches</li>
                        <li>Focus on technical skills and fast-paced decision making</li>
                        <li>Small-sided games and futsal tournaments</li>
                        <li>Perfect for developing close control and creativity</li>
                    </ul>
                    <div class="location"><strong>Location: <a href="https://www.google.com/maps/search/?api=1&query=1016+Investment+Blvd" target="_blank">XLSW Apex</a></strong></div>
                </div>
                <div class="image-container">
                    <img src="images/XLSWAPEX.png" alt="Indoor Soccer">
                    <img src="images/USFUTSAL.png" alt="US Futsal">
                </div>
            </div>
        </div>

        <!-- Outdoor Soccer -->
        <div class="sport-option">
            <div class="sport-header">
                <input type="checkbox" id="outdoor-soccer" name="programs" value="Outdoor Soccer" checked disabled>
                <span class="sport-title">Outdoor Soccer (Required)</span>
            </div>
            <div class="sport-details">
                <div class="text-content">
                    <div class="timeline"><strong>March - May and August - October</strong></div>
                    <div class="age-group"><strong>2010s and younger</strong></div>
                    <div class="schedule"><strong>Mon/Tue/Sat/Sun Evenings</strong></div>
                    <ul>
                        <li>Professional, licensed coaches</li>
                        <li>Emphasis on tactical understanding and game intelligence</li>
                        <li>Competitive matches through US Club Soccer</li>
                        <li>Position-specific training</li>
                        <li>Focus on building complete players</li>
                    </ul>
                    <div class="location"><strong>Location: <a href="https://www.google.com/maps/search/?api=1&query=425+Mills+Park+Dr,+Cary,+NC+27519" target="_blank">Mills Park</a> and <a href="https://www.google.com/maps/search/?api=1&query=511+Scott+King+Rd,+Durham,+NC+27713" target="_blank">CM Herndon Park</a></strong></div>
                </div>
                <div class="image-container">
                    <img src="images/CPR.png" alt="Cary Parks">
                    <img src="images/DPR.png" alt="Durham Parks">
                    <img src="images/USCLUBSOCCER.webp" alt="US Club Soccer">
                </div>
            </div>
        </div>

        <!-- Small Group Training -->
        <div class="sport-option">
            <div class="sport-header">
                <input type="checkbox" id="small-group" name="programs" value="Small Group Training" checked disabled>
                <span class="sport-title">Small Group Training (Required)</span>
            </div>
            <div class="sport-details">
                <div class="text-content">
                    <div class="timeline"><strong>Year-round</strong></div>
                    <div class="age-group"><strong>2010s and younger</strong></div>
                    <div class="schedule"><strong>Flexible scheduling</strong></div>
                    <ul>
                        <li>Professional, licensed coaches</li>
                        <li>Maximum 4 players per coach</li>
                        <li>Personalized attention and feedback</li>
                        <li>Focused skill development</li>
                        <li>Custom training plans based on player needs</li>
                    </ul>
                    <div class="location"><strong>Location: <a href="https://www.google.com/maps/search/?api=1&query=1250+Ambergate+Station,+Apex,+NC+27502" target="_blank">Hunter Street Park</a>, <a href="https://www.google.com/maps/search/?api=1&query=2600+Evans+Rd,+Apex,+NC+27502" target="_blank">Apex Nature Park</a>, or <a href="https://www.google.com/maps/search/?api=1&query=1016+Investment+Blvd" target="_blank">XLSW Apex</a></strong></div>
                </div>
                <div class="image-container">
                    <img src="images/XLSWAPEX.png" alt="XLSW Apex">
                    <!-- Placeholder for Apex Parks Rec logo -->
                </div>
            </div>
        </div>

        <!-- Judo -->
        <div class="sport-option">
            <div class="sport-header">
                <input type="checkbox" id="judo" name="programs" value="Judo">
                <span class="sport-title">Judo</span>
            </div>
            <div class="sport-details">
                <div class="text-content">
                    <div class="timeline"><strong>October - February and May - August</strong></div>
                    <div class="age-group"><strong>2010s and younger</strong></div>
                    <div class="schedule"><strong>Wed/Fri 5PM</strong></div>
                    <ul>
                        <li>Professional, licensed coaches</li>
                        <li>Led by experienced black belt instructors</li>
                        <li>Develops balance, coordination, and mental discipline</li>
                        <li>Used by top clubs like Ajax for youth training</li>
                        <li>Enhances physical and mental resilience</li>
                        <li>Builds confidence and self-defense skills</li>
                    </ul>
                    <div class="location"><strong>Location: <a href="https://www.google.com/maps/search/?api=1&query=5563+Western+Blvd,+Suite+12,+Raleigh,+NC+27606" target="_blank">Cary Judo Club</a></strong></div>
                </div>
                <div class="image-container">
                    <img src="images/CARYJUDOCLUB.png" alt="Judo">
                </div>
            </div>
        </div>

        <!-- Flag Football -->
        <div class="sport-option">
            <div class="sport-header">
                <input type="checkbox" id="flag-football" name="programs" value="Flag Football">
                <span class="sport-title">Flag Football</span>
            </div>
            <div class="sport-details">
                <div class="text-content">
                    <div class="timeline"><strong>March - May and August - October</strong></div>
                    <div class="age-group"><strong>2010s and younger</strong></div>
                    <div class="schedule"><strong>Wed/Sat 4-6PM</strong></div>
                    <div class="coaches"><strong>Professional, licensed coaches</strong></div>
                    <ul>
                        <li>Non-contact skill development</li>
                        <li>Focus on agility and strategic thinking</li>
                        <li>Great for developing overall athleticism</li>
                        <li>Teaches field awareness and spatial recognition</li>
                        <li>Enhances creative thinking for set pieces in soccer</li>
                        <li>Fun way to cross-train</li>
                    </ul>
                    <div class="location"><strong>Location: <a href="https://www.google.com/maps/search/?api=1&query=1016+Investment+Blvd" target="_blank">XLSW Apex</a></strong></div>
                </div>
                <div class="image-container">
                    <img src="images/XLSWAPEX.png" alt="Flag Football">
                </div>
            </div>
        </div>

        <!-- Basketball -->
        <div class="sport-option">
            <div class="sport-header">
                <input type="checkbox" name="sports" value="basketball" disabled>
                <span class="sport-title">Basketball</span>
            </div>
            <div class="sport-details">
                <p style="font-weight: bold; text-transform: uppercase;">COMING SOON</p>
            </div>
        </div>

        <!-- Tumbling Gymnastics -->
        <div class="sport-option">
            <div class="sport-header">
                <input type="checkbox" name="sports" value="tumbling-gymnastics" disabled>
                <span class="sport-title">Tumbling Gymnastics</span>
            </div>
            <div class="sport-details">
                <p style="font-weight: bold; text-transform: uppercase;">COMING SOON</p>
            </div>
        </div>

        <button id="next-step">NEXT</button>
    </div>

    <!-- Personal information and day selection section -->
    <div class="program-content" id="personal-info" style="display: none;">
        <form id="player-info-form">
            <h3>Player Information</h3>
            
            <!-- Parent section -->
            <div class="form-row parent-section">
                <div class="form-group">
                    <label for="parent-first-name">Parent First Name:</label>
                    <input type="text" id="parent-first-name" name="parent-first-name" required>
                </div>
                <div class="form-group">
                    <label for="parent-last-name">Parent Last Name:</label>
                    <input type="text" id="parent-last-name" name="parent-last-name" required>
                </div>
                <button type="button" class="add-parent-button" title="Add Parent/Guardian">+</button>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="first-name">Player First Name:</label>
                    <input type="text" id="first-name" name="first-name" required>
                </div>
                <div class="form-group">
                    <label for="last-name">Player Last Name:</label>
                    <input type="text" id="last-name" name="last-name" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number:</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="birth-year">Birth Year:</label>
                    <input type="number" id="birth-year" name="birth-year" required>
                </div>
            </div>

            <h3>Program Days</h3>
            <div id="program-days"></div>

            <div class="navigation-buttons">
                <button type="button" id="go-back">Go Back</button>
                <button type="button" id="to-summary">Next</button>
            </div>
        </form>
    </div>

    <!-- Add new summary section -->
    <div class="program-content" id="summary-section" style="display: none;">
        <h3>Program Summary</h3>
        <div id="summary-content"></div>
        
        <div class="navigation-buttons">
            <button type="button" id="back-to-form">Go Back</button>
            <button type="submit" id="submit-final">Submit</button>
        </div>
    </div>

    <script>
        VANTA.CELLS({
            el: "#vanta-bg",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: 200.00,
            minWidth: 200.00,
            scale: 1.00,
            color1: 0x045034,
            color2: 0x109963,
            size: 0.20,
            speed: 0.00
        });

        document.getElementById('build-program').addEventListener('click', function() {
            document.querySelector('.program-content').scrollIntoView({ behavior: 'smooth', block: 'start' });
        });

        document.getElementById('next-step').addEventListener('click', function() {
            scrollToTop();
            
            const selectedPrograms = [];
            document.querySelectorAll('input[name="programs"]:checked').forEach(checkbox => {
                selectedPrograms.push(checkbox.value);
            });

            // Check if at least 2 optional programs are selected
            const optionalPrograms = selectedPrograms.filter(program => 
                !["Indoor Soccer", "Outdoor Soccer", "Small Group Training"].includes(program)
            );

            if (optionalPrograms.length < 2) {
                alert('Please select at least 2 additional programs (Judo, Flag Football, etc.)');
                return;
            }

            localStorage.setItem('selectedPrograms', JSON.stringify(selectedPrograms));
            document.getElementById('program-selection').style.display = 'none';
            document.getElementById('personal-info').style.display = 'block';
            document.getElementById('summary-section').style.display = 'none';

            // Load preloaded data if it exists
            const playerData = JSON.parse(localStorage.getItem('playerData')) || {};
            
            // Fill in the form fields
            document.getElementById('first-name').value = playerData.firstName || '';
            document.getElementById('last-name').value = playerData.lastName || '';
            document.getElementById('email').value = playerData.email || '';
            document.getElementById('phone').value = playerData.phone || '';
            document.getElementById('birth-year').value = playerData.birthYear || '';

            // Show program days based on birth year and selected programs
            const birthYear = parseInt(playerData.birthYear) || 2015;
            const programDays = document.getElementById('program-days');
            programDays.innerHTML = '';

            selectedPrograms.forEach(program => {
                if (program === "Indoor Soccer" || program === "Outdoor Soccer") {
                    const days = birthYear >= 2015 ? ['Tuesday', 'Saturday'] : ['Monday', 'Sunday'];
                    programDays.innerHTML += `
                        <div class="program-days-selection">
                            <h4>${program}</h4>
                            ${days.map(day => `
                                <label>
                                    <input type="checkbox" checked disabled> ${day}
                                </label>
                            `).join('')}
                        </div>`;
                }
                if (program === "Judo") {
                    programDays.innerHTML += `
                        <div class="program-days-selection">
                            <h4>Judo</h4>
                            <label><input type="checkbox" name="judo-days"> Wednesday</label>
                            <label><input type="checkbox" name="judo-days"> Friday</label>
                        </div>`;
                }
                if (program === "Flag Football") {
                    programDays.innerHTML += `
                        <div class="program-days-selection">
                            <h4>Flag Football</h4>
                            <label><input type="checkbox" checked disabled> Friday</label>
                            <label><input type="checkbox" checked disabled> Sunday</label>
                        </div>`;
                }
                if (program === "Small Group Training") {
                    programDays.innerHTML += `
                        <div class="program-days-selection">
                            <h4>Small Group Training</h4>
                            <div class="location-options">
                                <h4>Locations</h4>
                                <label><input type="checkbox" name="sg-locations"> Hunter Street Park</label>
                                <label><input type="checkbox" name="sg-locations"> Apex Nature Park</label>
                                <label><input type="checkbox" name="sg-locations"> XLSW Apex</label>
                            </div>
                            <div class="day-options">
                                <h4>Available Days</h4>
                                <label><input type="checkbox" name="sg-days"> Monday</label>
                                <label><input type="checkbox" name="sg-days"> Tuesday</label>
                                <label><input type="checkbox" name="sg-days"> Wednesday</label>
                                <label><input type="checkbox" name="sg-days"> Thursday</label>
                                <label><input type="checkbox" name="sg-days"> Friday</label>
                                <label><input type="checkbox" name="sg-days"> Saturday</label>
                                <label><input type="checkbox" name="sg-days"> Sunday</label>
                            </div>
                        </div>`;
                }
            });
        });

        document.getElementById('player-info-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const playerData = {
                parentFirstName: formData.get('parent-first-name'),
                parentLastName: formData.get('parent-last-name'),
                firstName: formData.get('first-name'),
                lastName: formData.get('last-name'),
                birthYear: formData.get('birth-year'),
                email: formData.get('email'),
                phone: formData.get('phone')
            };
            localStorage.setItem('playerData', JSON.stringify(playerData));
            alert('Information submitted successfully!');
        });

        // Preload test data for HOLDEN2024
        const testCode = "HOLDEN2024";
        if (testCode === "HOLDEN2024") {
            const preloadData = {
                firstName: "Holden",
                lastName: "Hitchcock",
                birthYear: "2015",
                email: "hitchcock.derick@gmail.com",
                phone: "+19194515282"
            };
            localStorage.setItem('playerData', JSON.stringify(preloadData));
        }

        // Update the add parent functionality
        document.querySelector('.add-parent-button').addEventListener('click', function() {
            const parentSection = document.createElement('div');
            parentSection.className = 'form-row parent-section';
            parentSection.innerHTML = `
                <div class="form-group">
                    <label for="additional-parent-first-name">Parent First Name:</label>
                    <input type="text" name="additional-parent-first-name">
                </div>
                <div class="form-group">
                    <label for="additional-parent-last-name">Parent Last Name:</label>
                    <input type="text" name="additional-parent-last-name">
                </div>
                <button type="button" class="remove-parent-button" title="Remove Parent/Guardian">âˆ’</button>
            `;
            
            // Insert after the last parent section
            const lastParentSection = [...document.querySelectorAll('.parent-section')].pop();
            lastParentSection.after(parentSection);

            // Add remove functionality
            parentSection.querySelector('.remove-parent-button').addEventListener('click', function() {
                parentSection.remove();
            });
        });

        // Navigation functionality
        document.getElementById('go-back').addEventListener('click', function() {
            scrollToTop();
            document.getElementById('personal-info').style.display = 'none';
            document.getElementById('program-selection').style.display = 'block';
        });

        document.getElementById('to-summary').addEventListener('click', function(e) {
            e.preventDefault();
            scrollToTop();
            
            // Remove any existing error messages
            document.querySelectorAll('.error-message').forEach(msg => msg.remove());
            document.querySelectorAll('.input-error').forEach(input => input.classList.remove('input-error'));
            
            let isValid = true;
            
            // Validate parent information
            const parentFirstName = document.getElementById('parent-first-name');
            const parentLastName = document.getElementById('parent-last-name');
            if (!parentFirstName.value.trim()) {
                showError(parentFirstName, 'Parent first name is required');
                isValid = false;
            }
            if (!parentLastName.value.trim()) {
                showError(parentLastName, 'Parent last name is required');
                isValid = false;
            }
            
            // Validate player information
            const requiredFields = ['first-name', 'last-name', 'email', 'phone', 'birth-year'];
            requiredFields.forEach(field => {
                const input = document.getElementById(field);
                if (!input.value.trim()) {
                    showError(input, `${field.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())} is required`);
                    isValid = false;
                }
            });
            
            // Validate Small Group Training selections
            const smallGroupSelected = JSON.parse(localStorage.getItem('selectedPrograms')).includes('Small Group Training');
            if (smallGroupSelected) {
                const locations = document.querySelectorAll('[name="sg-locations"]:checked');
                const days = document.querySelectorAll('[name="sg-days"]:checked');
                
                if (locations.length === 0) {
                    showError(document.querySelector('.location-options'), 'Please select at least one location');
                    isValid = false;
                }
                if (days.length === 0) {
                    showError(document.querySelector('.day-options'), 'Please select at least one day');
                    isValid = false;
                }
            }
            
            // Validate Judo days if selected
            const judoSelected = JSON.parse(localStorage.getItem('selectedPrograms')).includes('Judo');
            if (judoSelected) {
                const judoDays = document.querySelectorAll('[name="judo-days"]:checked');
                if (judoDays.length === 0) {
                    showError(document.querySelector('[name="judo-days"]').closest('.program-days-selection'), 
                             'Please select at least one day for Judo');
                    isValid = false;
                }
            }
            
            if (!isValid) {
                scrollToTop();
                return;
            }
            
            // If all valid, proceed to summary
            // Get all form data
            const formData = new FormData(document.getElementById('player-info-form'));
            const selectedPrograms = JSON.parse(localStorage.getItem('selectedPrograms'));
            
            // Get selected days for Judo
            const selectedJudoDays = [...document.querySelectorAll('[name="judo-days"]:checked')]
                .map(cb => cb.parentElement.textContent.trim());
            
            // Get selected small group training options
            const selectedLocations = [...document.querySelectorAll('[name="sg-locations"]:checked')]
                .map(cb => cb.parentElement.textContent.trim());
            const selectedDays = [...document.querySelectorAll('[name="sg-days"]:checked')]
                .map(cb => cb.parentElement.textContent.trim());
            
            // Create summary HTML
            const summaryContent = document.getElementById('summary-content');
            summaryContent.innerHTML = `
                <div class="summary-section">
                    <div class="summary-block">
                        <h4>Player Information</h4>
                        <div class="summary-item">
                            <strong>Name:</strong> ${formData.get('first-name')} ${formData.get('last-name')}
                        </div>
                        <div class="summary-item">
                            <strong>Birth Year:</strong> ${formData.get('birth-year')}
                        </div>
                    </div>

                    <div class="summary-block">
                        <h4>Parent Information</h4>
                        <div class="summary-item">
                            <strong>Primary Parent:</strong> ${formData.get('parent-first-name')} ${formData.get('parent-last-name')}
                        </div>
                        ${[...document.querySelectorAll('[name="additional-parent-first-name"]')].map((input, i) => `
                            <div class="summary-item">
                                <strong>Additional Parent ${i + 1}:</strong> ${input.value} ${document.querySelectorAll('[name="additional-parent-last-name"]')[i].value}
                            </div>
                        `).join('')}
                    </div>

                    <div class="summary-block">
                        <h4>Contact Information</h4>
                        <div class="summary-item">
                            <strong>Email:</strong> ${formData.get('email')}
                        </div>
                        <div class="summary-item">
                            <strong>Phone:</strong> ${formData.get('phone')}
                        </div>
                    </div>

                    <div class="summary-block">
                        <h4>Selected Programs and Schedule</h4>
                        ${selectedPrograms.map(program => {
                            if (program === "Small Group Training") {
                                return `
                                    <div class="program-summary">
                                        <h5>${program}</h5>
                                        <div class="summary-item">
                                            <strong>Training Locations:</strong> ${selectedLocations.join(', ') || 'None selected'}
                                        </div>
                                        <div class="summary-item">
                                            <strong>Training Days:</strong> ${selectedDays.join(', ') || 'None selected'}
                                        </div>
                                    </div>`;
                            } else if (program === "Judo") {
                                return `
                                    <div class="program-summary">
                                        <h5>${program}</h5>
                                        <div class="summary-item">
                                            <strong>Training Days:</strong> ${selectedJudoDays.join(', ') || 'None selected'}
                                        </div>
                                    </div>`;
                            } else {
                                const birthYear = parseInt(formData.get('birth-year'));
                                let days = '';
                                if (program === "Indoor Soccer" || program === "Outdoor Soccer") {
                                    days = birthYear >= 2015 ? 'Tuesday, Saturday' : 'Monday, Sunday';
                                } else if (program === "Flag Football") {
                                    days = 'Friday, Sunday';
                                }
                                return `
                                    <div class="program-summary">
                                        <h5>${program}</h5>
                                        <div class="summary-item">
                                            <strong>Training Days:</strong> ${days}
                                        </div>
                                    </div>`;
                            }
                        }).join('')}
                    </div>

                    <div class="summary-block">
                        <h4>Payment Information</h4>
                        <div class="summary-item">
                            <p>Monthly Program Fee: <strong>$200.00</strong></p>
                            <p>Please complete payment via Zelle to proceed:</p>
                            <div class="zelle-info">
                                <strong>Zelle Email:</strong> brett@apexraptors.com
                                <p>Amount: $200.00</p>
                                <a href="https://enroll.zellepay.com/qr-codes?data=brett@apexraptors.com" 
                                   class="zelle-button" 
                                   target="_blank">
                                   Pay with Zelle
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('personal-info').style.display = 'none';
            document.getElementById('summary-section').style.display = 'block';
        });

        // Helper function to show error messages
        function showError(element, message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            element.classList.add('input-error');
            element.parentNode.appendChild(errorDiv);
        }

        // Update the header click event listener
        document.querySelectorAll('.sport-header').forEach(header => {
            header.addEventListener('click', function(e) {
                const checkbox = this.querySelector('input[type="checkbox"]');
                if (!checkbox.disabled && e.target !== checkbox) {  // Only toggle if not disabled and not clicking checkbox directly
                    checkbox.checked = !checkbox.checked;
                }
            });
        });

        // Add back the event listener for the back-to-form button
        document.getElementById('back-to-form').addEventListener('click', function() {
            scrollToTop();
            document.getElementById('summary-section').style.display = 'none';
            document.getElementById('personal-info').style.display = 'block';
        });

        // Update submit handler to send a cleaner format
        document.getElementById('submit-final').addEventListener('click', function(e) {
            e.preventDefault();
            scrollToTop();
            
            const formData = new FormData(document.getElementById('player-info-form'));
            const selectedPrograms = JSON.parse(localStorage.getItem('selectedPrograms'));
            
            // Create a clean formatted message
            const emailMessage = `
                APEX ATHLETIC CLUB - NEW REGISTRATION
                
                PLAYER INFORMATION
                ------------------
                Name: ${formData.get('first-name')} ${formData.get('last-name')}
                Birth Year: ${formData.get('birth-year')}
                
                PARENT INFORMATION
                -----------------
                Primary Parent: ${formData.get('parent-first-name')} ${formData.get('parent-last-name')}
                Email: ${formData.get('email')}
                Phone: ${formData.get('phone')}
                
                PROGRAM SCHEDULE
                ---------------
                ${selectedPrograms.map(program => {
                    let schedule = '';
                    if (program === "Small Group Training") {
                        const locations = [...document.querySelectorAll('[name="sg-locations"]:checked')]
                            .map(cb => cb.parentElement.textContent.trim()).join(', ');
                        const days = [...document.querySelectorAll('[name="sg-days"]:checked')]
                            .map(cb => cb.parentElement.textContent.trim()).join(', ');
                        schedule = `\n    Location: ${locations}\n    Days: ${days}`;
                    } else if (program === "Judo") {
                        const days = [...document.querySelectorAll('[name="judo-days"]:checked')]
                            .map(cb => cb.parentElement.textContent.trim()).join(', ');
                        schedule = `\n    Days: ${days}`;
                    } else if (program === "Indoor Soccer" || program === "Outdoor Soccer") {
                        const days = parseInt(formData.get('birth-year')) >= 2015 ? 'Tuesday, Saturday' : 'Monday, Sunday';
                        schedule = `\n    Days: ${days}`;
                    } else if (program === "Flag Football") {
                        schedule = '\n    Days: Friday, Sunday';
                    }
                    return `${program}${schedule}`;
                }).join('\n\n')}
                
                PAYMENT INFORMATION
                ------------------
                Monthly Fee: $200.00
                Payment Method: Zelle
                Payment Email: brett@apexraptors.com
            `.replace(/^\s+/gm, ''); // Remove leading whitespace

            // First send admin notification
            emailjs.send("service_jqvfs2x", "template_3ls7ajq", {
                to_email: "brett@apexraptors.com",
                from_name: `${formData.get('first-name')} ${formData.get('last-name')}`,
                player_name: `${formData.get('first-name')} ${formData.get('last-name')}`,
                birth_year: formData.get('birth-year'),
                parent_name: `${formData.get('parent-first-name')} ${formData.get('parent-last-name')}`,
                email: formData.get('email'),
                phone: formData.get('phone'),
                message: emailMessage
            }).then(function(response) {
                // Then send confirmation to player
                return emailjs.send("service_jqvfs2x", "template_3ls7ajq", {
                    to_email: formData.get('email'),
                    from_name: "Apex Athletic Club",
                    player_name: `${formData.get('first-name')} ${formData.get('last-name')}`,
                    birth_year: formData.get('birth-year'),
                    parent_name: `${formData.get('parent-first-name')} ${formData.get('parent-last-name')}`,
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    message: `Thank you for registering with Apex Athletic Club!\n\n${emailMessage}`
                });
            }).then(
                function(response) {
                    alert("Registration submitted successfully! You will receive a confirmation email shortly.");
                    window.location.href = '/';
                },
                function(error) {
                    console.log("FAILED", error);
                    alert(`Error submitting registration: ${error.text}`);
                }
            );
        });

        // Update the scrollToTop function to use window.scrollTo
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html> 